#include "goldilocks_cubic_extension.hpp"
#include "zhInv.hpp"
#include "starks.hpp"
#include "constant_pols_starks.hpp"
#include "allSteps.hpp"

void AllSteps::step1_first(StepsParams &params, uint64_t i) {
     Goldilocks::copy(params.pols[76803 + i*67], params.pols[11 + i*33]);
     Goldilocks::Element tmp_0;
     Goldilocks::copy(tmp_0, params.pols[12 + i*33]);
     Goldilocks::Element tmp_1;
     Goldilocks::copy(tmp_1, tmp_0);
     Goldilocks::mul(params.pols[76800 + i*67], tmp_1, params.pols[76803 + i*67]);
     Goldilocks::Element tmp_2;
     Goldilocks::copy(tmp_2, params.pols[13 + ((i + 1)%1024)*33]);
     Goldilocks::Element tmp_3;
     Goldilocks::copy(tmp_3, tmp_2);
     Goldilocks::mul(params.pols[76801 + i*67], tmp_3, params.pols[76803 + i*67]);
     Goldilocks::Element tmp_4;
     Goldilocks::mul(tmp_4, params.pols[12 + i*33], params.pols[13 + ((i + 1)%1024)*33]);
     Goldilocks::Element tmp_5;
     Goldilocks::copy(tmp_5, tmp_4);
     Goldilocks::mul(params.pols[76802 + i*67], tmp_5, params.pols[76803 + i*67]);
     Goldilocks::copy(params.pols[76807 + i*67],  params.pConstPols->getElement(6,i));
     Goldilocks::Element tmp_6;
     Goldilocks::copy(tmp_6,  params.pConstPols->getElement(7,i));
     Goldilocks::Element tmp_7;
     Goldilocks::copy(tmp_7, tmp_6);
     Goldilocks::mul(params.pols[76804 + i*67], tmp_7, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_8;
     Goldilocks::copy(tmp_8,  params.pConstPols->getElement(8,i));
     Goldilocks::Element tmp_9;
     Goldilocks::copy(tmp_9, tmp_8);
     Goldilocks::mul(params.pols[76805 + i*67], tmp_9, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_10;
     Goldilocks::copy(tmp_10, params.pols[14 + i*33]);
     Goldilocks::Element tmp_11;
     Goldilocks::copy(tmp_11, tmp_10);
     Goldilocks::mul(params.pols[76806 + i*67], tmp_11, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_12;
     Goldilocks::copy(tmp_12, params.pols[15 + i*33]);
     Goldilocks::copy(params.pols[76808 + i*67], tmp_12);
     Goldilocks::Element tmp_13;
     Goldilocks::copy(tmp_13, params.pols[16 + i*33]);
     Goldilocks::copy(params.pols[76809 + i*67], tmp_13);
     Goldilocks::Element tmp_14;
     Goldilocks::copy(tmp_14, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76810 + i*67], tmp_14);
     Goldilocks::Element tmp_15;
     Goldilocks::copy(tmp_15, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76811 + i*67], tmp_15);
     Goldilocks::Element tmp_16;
     Goldilocks::copy(tmp_16, params.pols[17 + i*33]);
     Goldilocks::copy(params.pols[76812 + i*67], tmp_16);
     Goldilocks::Element tmp_17;
     Goldilocks::copy(tmp_17, params.pols[18 + i*33]);
     Goldilocks::copy(params.pols[76813 + i*67], tmp_17);
     Goldilocks::Element tmp_18;
     Goldilocks::copy(tmp_18, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76814 + i*67], tmp_18);
     Goldilocks::Element tmp_19;
     Goldilocks::copy(tmp_19, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76815 + i*67], tmp_19);
     Goldilocks::Element tmp_20;
     Goldilocks::copy(tmp_20, params.pols[19 + i*33]);
     Goldilocks::copy(params.pols[76816 + i*67], tmp_20);
     Goldilocks::Element tmp_21;
     Goldilocks::copy(tmp_21, params.pols[20 + i*33]);
     Goldilocks::copy(params.pols[76817 + i*67], tmp_21);
     Goldilocks::Element tmp_22;
     Goldilocks::copy(tmp_22, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76818 + i*67], tmp_22);
     Goldilocks::Element tmp_23;
     Goldilocks::copy(tmp_23, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76819 + i*67], tmp_23);
     Goldilocks::Element tmp_24;
     Goldilocks::copy(tmp_24, params.pols[21 + i*33]);
     Goldilocks::copy(params.pols[76820 + i*67], tmp_24);
     Goldilocks::Element tmp_25;
     Goldilocks::copy(tmp_25, params.pols[22 + i*33]);
     Goldilocks::copy(params.pols[76821 + i*67], tmp_25);
     Goldilocks::Element tmp_26;
     Goldilocks::copy(tmp_26, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76822 + i*67], tmp_26);
     Goldilocks::Element tmp_27;
     Goldilocks::copy(tmp_27, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76823 + i*67], tmp_27);
     Goldilocks::Element tmp_28;
     Goldilocks::copy(tmp_28, params.pols[23 + i*33]);
     Goldilocks::copy(params.pols[76824 + i*67], tmp_28);
     Goldilocks::Element tmp_29;
     Goldilocks::copy(tmp_29, params.pols[24 + i*33]);
     Goldilocks::copy(params.pols[76825 + i*67], tmp_29);
     Goldilocks::Element tmp_30;
     Goldilocks::copy(tmp_30, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76826 + i*67], tmp_30);
     Goldilocks::Element tmp_31;
     Goldilocks::copy(tmp_31, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76827 + i*67], tmp_31);
}

void AllSteps::step1_i(StepsParams &params, uint64_t i) {
     Goldilocks::copy(params.pols[76803 + i*67], params.pols[11 + i*33]);
     Goldilocks::Element tmp_0;
     Goldilocks::copy(tmp_0, params.pols[12 + i*33]);
     Goldilocks::Element tmp_1;
     Goldilocks::copy(tmp_1, tmp_0);
     Goldilocks::mul(params.pols[76800 + i*67], tmp_1, params.pols[76803 + i*67]);
     Goldilocks::Element tmp_2;
     Goldilocks::copy(tmp_2, params.pols[13 + ((i + 1)%1024)*33]);
     Goldilocks::Element tmp_3;
     Goldilocks::copy(tmp_3, tmp_2);
     Goldilocks::mul(params.pols[76801 + i*67], tmp_3, params.pols[76803 + i*67]);
     Goldilocks::Element tmp_4;
     Goldilocks::mul(tmp_4, params.pols[12 + i*33], params.pols[13 + ((i + 1)%1024)*33]);
     Goldilocks::Element tmp_5;
     Goldilocks::copy(tmp_5, tmp_4);
     Goldilocks::mul(params.pols[76802 + i*67], tmp_5, params.pols[76803 + i*67]);
     Goldilocks::copy(params.pols[76807 + i*67],  params.pConstPols->getElement(6,i));
     Goldilocks::Element tmp_6;
     Goldilocks::copy(tmp_6,  params.pConstPols->getElement(7,i));
     Goldilocks::Element tmp_7;
     Goldilocks::copy(tmp_7, tmp_6);
     Goldilocks::mul(params.pols[76804 + i*67], tmp_7, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_8;
     Goldilocks::copy(tmp_8,  params.pConstPols->getElement(8,i));
     Goldilocks::Element tmp_9;
     Goldilocks::copy(tmp_9, tmp_8);
     Goldilocks::mul(params.pols[76805 + i*67], tmp_9, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_10;
     Goldilocks::copy(tmp_10, params.pols[14 + i*33]);
     Goldilocks::Element tmp_11;
     Goldilocks::copy(tmp_11, tmp_10);
     Goldilocks::mul(params.pols[76806 + i*67], tmp_11, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_12;
     Goldilocks::copy(tmp_12, params.pols[15 + i*33]);
     Goldilocks::copy(params.pols[76808 + i*67], tmp_12);
     Goldilocks::Element tmp_13;
     Goldilocks::copy(tmp_13, params.pols[16 + i*33]);
     Goldilocks::copy(params.pols[76809 + i*67], tmp_13);
     Goldilocks::Element tmp_14;
     Goldilocks::copy(tmp_14, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76810 + i*67], tmp_14);
     Goldilocks::Element tmp_15;
     Goldilocks::copy(tmp_15, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76811 + i*67], tmp_15);
     Goldilocks::Element tmp_16;
     Goldilocks::copy(tmp_16, params.pols[17 + i*33]);
     Goldilocks::copy(params.pols[76812 + i*67], tmp_16);
     Goldilocks::Element tmp_17;
     Goldilocks::copy(tmp_17, params.pols[18 + i*33]);
     Goldilocks::copy(params.pols[76813 + i*67], tmp_17);
     Goldilocks::Element tmp_18;
     Goldilocks::copy(tmp_18, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76814 + i*67], tmp_18);
     Goldilocks::Element tmp_19;
     Goldilocks::copy(tmp_19, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76815 + i*67], tmp_19);
     Goldilocks::Element tmp_20;
     Goldilocks::copy(tmp_20, params.pols[19 + i*33]);
     Goldilocks::copy(params.pols[76816 + i*67], tmp_20);
     Goldilocks::Element tmp_21;
     Goldilocks::copy(tmp_21, params.pols[20 + i*33]);
     Goldilocks::copy(params.pols[76817 + i*67], tmp_21);
     Goldilocks::Element tmp_22;
     Goldilocks::copy(tmp_22, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76818 + i*67], tmp_22);
     Goldilocks::Element tmp_23;
     Goldilocks::copy(tmp_23, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76819 + i*67], tmp_23);
     Goldilocks::Element tmp_24;
     Goldilocks::copy(tmp_24, params.pols[21 + i*33]);
     Goldilocks::copy(params.pols[76820 + i*67], tmp_24);
     Goldilocks::Element tmp_25;
     Goldilocks::copy(tmp_25, params.pols[22 + i*33]);
     Goldilocks::copy(params.pols[76821 + i*67], tmp_25);
     Goldilocks::Element tmp_26;
     Goldilocks::copy(tmp_26, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76822 + i*67], tmp_26);
     Goldilocks::Element tmp_27;
     Goldilocks::copy(tmp_27, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76823 + i*67], tmp_27);
     Goldilocks::Element tmp_28;
     Goldilocks::copy(tmp_28, params.pols[23 + i*33]);
     Goldilocks::copy(params.pols[76824 + i*67], tmp_28);
     Goldilocks::Element tmp_29;
     Goldilocks::copy(tmp_29, params.pols[24 + i*33]);
     Goldilocks::copy(params.pols[76825 + i*67], tmp_29);
     Goldilocks::Element tmp_30;
     Goldilocks::copy(tmp_30, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76826 + i*67], tmp_30);
     Goldilocks::Element tmp_31;
     Goldilocks::copy(tmp_31, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76827 + i*67], tmp_31);
}

void AllSteps::step1_last(StepsParams &params, uint64_t i) {
     Goldilocks::copy(params.pols[76803 + i*67], params.pols[11 + i*33]);
     Goldilocks::Element tmp_0;
     Goldilocks::copy(tmp_0, params.pols[12 + i*33]);
     Goldilocks::Element tmp_1;
     Goldilocks::copy(tmp_1, tmp_0);
     Goldilocks::mul(params.pols[76800 + i*67], tmp_1, params.pols[76803 + i*67]);
     Goldilocks::Element tmp_2;
     Goldilocks::copy(tmp_2, params.pols[13 + ((i + 1)%1024)*33]);
     Goldilocks::Element tmp_3;
     Goldilocks::copy(tmp_3, tmp_2);
     Goldilocks::mul(params.pols[76801 + i*67], tmp_3, params.pols[76803 + i*67]);
     Goldilocks::Element tmp_4;
     Goldilocks::mul(tmp_4, params.pols[12 + i*33], params.pols[13 + ((i + 1)%1024)*33]);
     Goldilocks::Element tmp_5;
     Goldilocks::copy(tmp_5, tmp_4);
     Goldilocks::mul(params.pols[76802 + i*67], tmp_5, params.pols[76803 + i*67]);
     Goldilocks::copy(params.pols[76807 + i*67],  params.pConstPols->getElement(6,i));
     Goldilocks::Element tmp_6;
     Goldilocks::copy(tmp_6,  params.pConstPols->getElement(7,i));
     Goldilocks::Element tmp_7;
     Goldilocks::copy(tmp_7, tmp_6);
     Goldilocks::mul(params.pols[76804 + i*67], tmp_7, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_8;
     Goldilocks::copy(tmp_8,  params.pConstPols->getElement(8,i));
     Goldilocks::Element tmp_9;
     Goldilocks::copy(tmp_9, tmp_8);
     Goldilocks::mul(params.pols[76805 + i*67], tmp_9, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_10;
     Goldilocks::copy(tmp_10, params.pols[14 + i*33]);
     Goldilocks::Element tmp_11;
     Goldilocks::copy(tmp_11, tmp_10);
     Goldilocks::mul(params.pols[76806 + i*67], tmp_11, params.pols[76807 + i*67]);
     Goldilocks::Element tmp_12;
     Goldilocks::copy(tmp_12, params.pols[15 + i*33]);
     Goldilocks::copy(params.pols[76808 + i*67], tmp_12);
     Goldilocks::Element tmp_13;
     Goldilocks::copy(tmp_13, params.pols[16 + i*33]);
     Goldilocks::copy(params.pols[76809 + i*67], tmp_13);
     Goldilocks::Element tmp_14;
     Goldilocks::copy(tmp_14, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76810 + i*67], tmp_14);
     Goldilocks::Element tmp_15;
     Goldilocks::copy(tmp_15, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76811 + i*67], tmp_15);
     Goldilocks::Element tmp_16;
     Goldilocks::copy(tmp_16, params.pols[17 + i*33]);
     Goldilocks::copy(params.pols[76812 + i*67], tmp_16);
     Goldilocks::Element tmp_17;
     Goldilocks::copy(tmp_17, params.pols[18 + i*33]);
     Goldilocks::copy(params.pols[76813 + i*67], tmp_17);
     Goldilocks::Element tmp_18;
     Goldilocks::copy(tmp_18, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76814 + i*67], tmp_18);
     Goldilocks::Element tmp_19;
     Goldilocks::copy(tmp_19, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76815 + i*67], tmp_19);
     Goldilocks::Element tmp_20;
     Goldilocks::copy(tmp_20, params.pols[19 + i*33]);
     Goldilocks::copy(params.pols[76816 + i*67], tmp_20);
     Goldilocks::Element tmp_21;
     Goldilocks::copy(tmp_21, params.pols[20 + i*33]);
     Goldilocks::copy(params.pols[76817 + i*67], tmp_21);
     Goldilocks::Element tmp_22;
     Goldilocks::copy(tmp_22, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76818 + i*67], tmp_22);
     Goldilocks::Element tmp_23;
     Goldilocks::copy(tmp_23, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76819 + i*67], tmp_23);
     Goldilocks::Element tmp_24;
     Goldilocks::copy(tmp_24, params.pols[21 + i*33]);
     Goldilocks::copy(params.pols[76820 + i*67], tmp_24);
     Goldilocks::Element tmp_25;
     Goldilocks::copy(tmp_25, params.pols[22 + i*33]);
     Goldilocks::copy(params.pols[76821 + i*67], tmp_25);
     Goldilocks::Element tmp_26;
     Goldilocks::copy(tmp_26, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76822 + i*67], tmp_26);
     Goldilocks::Element tmp_27;
     Goldilocks::copy(tmp_27, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76823 + i*67], tmp_27);
     Goldilocks::Element tmp_28;
     Goldilocks::copy(tmp_28, params.pols[23 + i*33]);
     Goldilocks::copy(params.pols[76824 + i*67], tmp_28);
     Goldilocks::Element tmp_29;
     Goldilocks::copy(tmp_29, params.pols[24 + i*33]);
     Goldilocks::copy(params.pols[76825 + i*67], tmp_29);
     Goldilocks::Element tmp_30;
     Goldilocks::copy(tmp_30, params.pols[25 + i*33]);
     Goldilocks::copy(params.pols[76826 + i*67], tmp_30);
     Goldilocks::Element tmp_31;
     Goldilocks::copy(tmp_31, params.pols[26 + i*33]);
     Goldilocks::copy(params.pols[76827 + i*67], tmp_31);
}
